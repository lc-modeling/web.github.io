<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LC Modeling School Admin Dashboard</title>
    <style>
        .outfit {
            font-family: "Outfit", sans-serif;
            font-optical-sizing: auto;
            font-weight: 300;
            font-style: normal;
        }
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }
        .header {
            background-color: #4CAF50;
            color: white;
            padding: 20px;
            text-align: center;
        }
        .menu-toggle {
            display: none;
            background-color: #333;
            color: white;
            padding: 10px;
            text-align: center;
            cursor: pointer;
        }
        .sidebar {
            width: 200px;
            background-color: #333;
            position: fixed;
            height: 100%;
            top: 0;
            left: 0;
            padding-top: 60px;
            overflow: auto;
        }
        .sidebar a {
            padding: 15px;
            text-decoration: none;
            font-size: 18px;
            color: white;
            display: block;
        }
        .sidebar a:hover {
            background-color: #575757;
        }
        .content {
            margin-left: 220px;
            padding: 20px;
        }
        .card {
            background-color: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .card h3 {
            margin-top: 0;
        }
        .analytics {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
        }
        .analytics .card {
            flex: 1;
            margin: 10px;
        }
        .btn {
            display: inline-block;
            padding: 10px 20px;
            margin: 10px 0;
            background-color: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            text-align: center;
        }
        .btn:hover {
            background-color: #45a049;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid #dddddd;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .edit-btn, .delete-btn {
            padding: 5px 10px;
            margin-right: 5px;
            cursor: pointer;
            border: none;
            color: white;
            border-radius: 3px;
            transition: background-color 0.3s;
        }
        .edit-btn { background-color: #007bff; }
        .delete-btn { background-color: red; }
        .edit-btn:hover, .delete-btn:hover { opacity: 0.8; }
        .form-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .form-container > div {
            flex: 1;
            min-width: 200px;
        }
        label {
            display: block;
            margin-bottom: 8px;
        }
        input, textarea, button {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        textarea { resize: vertical; }
        @media (max-width: 768px) {
            .menu-toggle { display: block; }
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                display: none;
            }
            .sidebar a { float: left; }
            .content { margin-left: 0; }
            .analytics .card { flex: 1 1 100%; }
            table {
                display: block;
                width: 100%;
                overflow-x: auto;
            }
            table, th, td { display: block; width: 100%; }
            th, td { padding: 10px; }
            tbody tr {
                display: flex;
                flex-wrap: wrap;
                border: 1px solid #ddd;
                margin-bottom: 10px;
                border-radius: 5px;
                overflow: hidden;
            }
            tbody tr td { flex: 1 1 100%; padding: 10px; }
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>LC Modeling School Admin Dashboard</h1>
        <div class="menu-toggle" onclick="toggleSidebar()">â˜° Menu</div>
    </div>

    <div class="sidebar">
        <a href="#dashboard">Dashboard</a>
        <a href="#analytics">Analytics</a>
        <a href="https://app.firecms.co/p/schoolcms-77713/c/lcschoolblog">Update Blog</a>
        <a href="#students">Manage Students</a>
        <a href="#settings">Settings</a>
        <a href="index.html">Logout</a>
        <!-- New Analytics External Link -->
        <a href="https://analytics.google.com/analytics/web/?authuser=0#/p489768763/reports/intelligenthome" target="_blank">View GA Dashboard</a>
    </div>

    <div class="content">
        <div id="dashboard" class="card">
            <h3>Welcome, Admin!</h3>
            <p>Use the links on the sidebar to manage the LC Modeling School website.</p>
        </div>

        <div id="analytics" class="analytics">
            <div class="card">
                <h3>Student Enrollments</h3>
                <p id="student-enrollments">Loading...</p>
            </div>
            <div class="card">
                <h3>Courses Completed</h3>
                <p id="courses-completed">Loading...</p>
            </div>
            <div class="card">
                <h3>Active Blog Posts</h3>
                <p id="active-blog-posts">Loading...</p>
            </div>
        </div>
        <!-- Button to open full GA -->
        <a href="https://analytics.google.com/analytics/web/?authuser=0#/p489768763/reports/intelligenthome" class="btn" target="_blank">
            View Detailed Analytics
        </a>

       

        <div id="settings" class="card">
            <h3>blogs update</h3>
            <p>Update your blog and posts settings.</p>
            <a href="admindash/blogupdate.html" class="btn">update</a>
        </div>

        <div id="settings" class="card">
            <h3>LC stories</h3>
            <p>upload and update lc stories </p>
            <a href="admindash/lsstoriesupdate.html" class="btn">update</a>
        </div>
        <div id="settings" class="card">
            <h3>header image home </h3>
            <p>update home header image </p>
            <a href="admindash/mainheader.html" class="btn">update</a>
        </div>
        <div id="settings" class="card">
            <h3>L&C Models Management</h3>
            <p>update lc models management section photos and contet .</p>
            <a href="admindash/modeldash.html" class="btn">update</a>
        </div>
        <div id="settings" class="card">
            <h3>models/getcsouted header content</h3>
            <p>change or update models/getcsouted header content .</p>
            <a href="admindash/modelsheader.html" class="btn">update</a>
        </div>
        <div id="settings" class="card">
            <h3>diversity & INCLUSIVITY</h3>
            <p>update diversity and inclusivity section photos.</p>
            <a href="admindash/diversityupdate.html" class="btn">update</a>
        </div>
    </div>

    <!-- Firebase scripts -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-app.js";
        import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-database.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC1Mr82Gq9W8ede84OsnqgDx5saAuN6QII",
            authDomain: "lcmodelingcms.firebaseapp.com",
            projectId: "lcmodelingcms",
            storageBucket: "lcmodelingcms.appspot.com",
            messagingSenderId: "928501733809",
            appId: "1:928501733809:web:5dd437ee264debdf708590"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // Enroll student form submission
        document.getElementById("student-form").addEventListener("submit", function (event) {
            event.preventDefault();
            const name = document.getElementById("student-name").value;
            const email = document.getElementById("student-email").value;
            const phone = document.getElementById("student-phone").value;
            const address = document.getElementById("student-address").value;

            push(ref(db, 'students'), {
                name: name,
                email: email,
                phone: phone,
                address: address
            });

            document.getElementById("student-form").reset();
        });

        // Render students in table
        function renderStudents(students) {
            const tableBody = document.querySelector("#students-table tbody");
            tableBody.innerHTML = '';
            students.forEach(student => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${student.name}</td>
                    <td>${student.email}</td>
                    <td>${student.phone}</td>
                    <td>${student.address}</td>
                    <td>
                        <button class="edit-btn" data-key="${student['.key']}">Edit</button>
                        <button class="delete-btn" data-key="${student['.key']}">Delete</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
            document.querySelectorAll('.edit-btn').forEach(btn => btn.addEventListener('click', handleEditStudent));
            document.querySelectorAll('.delete-btn').forEach(btn => btn.addEventListener('click', handleDeleteStudent));
        }

        // Fetch and display students data
        const studentsRef = ref(db, 'students');
        onValue(studentsRef, snapshot => {
            const studentsData = snapshot.val();
            const studentsArray = studentsData ? Object.entries(studentsData).map(([key, value]) => ({ ...value, '.key': key })) : [];
            renderStudents(studentsArray);
        });

        // Edit student functionality
        function handleEditStudent(event) {
            const studentId = event.target.dataset.key;
            alert(`Edit functionality to be implemented for student ID: ${studentId}`);
        }

        // Delete student functionality
        function handleDeleteStudent(event) {
            const studentId = event.target.dataset.key;
            if (confirm("Are you sure you want to delete this student?")) {
                remove(ref(db, `students/${studentId}`))
                    .then(() => alert("Student deleted successfully!"))
                    .catch(error => console.error("Error deleting student: ", error));
            }
        }

        // Fetch and display analytics data
        const analyticsData = {
            "student-enrollments": ref(db, 'analytics/student-enrollments'),
            "courses-completed": ref(db, 'analytics/courses-completed'),
            "active-blog-posts": ref(db, 'analytics/active-blog-posts')
        };

        Object.keys(analyticsData).forEach(key => {
            onValue(analyticsData[key], snapshot => {
                document.getElementById(key).innerText = snapshot.val() || '0';
            });
        });

        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            sidebar.style.display = sidebar.style.display === 'block' ? 'none' : 'block';
        }
    </script>

</body>
</html>
